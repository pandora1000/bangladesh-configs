{const e="**VMInitInjection**";if(1!==window[e]){const t=function(){return this}(),{document:n,window:o}=t,a="Violentmonkey",r="auto",s="page",i="content",c="forceContent",l="injectInto",d="more",u=-1,p=2,f="response",w="sessionId",m=e=>"function"==typeof e,h=e=>null!=e&&"object"==typeof e,{location:b}=t,y="prototype",g=top===o,v="__CBID",R="fileName",_=e=>"string"==typeof e,k=(e,t,n)=>{try{e&&z(e,t)&&(n=e[t])}catch(e){}return n},C=(e,t,n,o=!0,a)=>de(e,t,{__proto__:null,[a||"value"]:n,[!a&&"writable"]:o,configurable:o,enumerable:o}),L=e=>le(we(),e),x=(e,t,n)=>(pe(e)&&(e=L(e)),t&&K(Q,n,n=>{z(t,n)&&(e[n]=t[n])}),e),M=(e,t,n,o)=>{var a;const r=e[t]||(e[t]=we());return null!=(a=r[n])?a:r[n]=null!=o?o:we()},$=async e=>e,T=(e="VM")=>e+me(),E=(e,...t)=>{let n=`[${a}]`;t[0]&&K(Q,t[0],e=>{n+=`[${e}]`}),t[0]=n,X(ve[e],ve,t)},S=(e,t)=>C(e,e.length,t),{Blob:D,CustomEvent:j,Error:P,MouseEvent:U,Object:I,Promise:O,Response:F,Uint8Array:N,atob:V,addEventListener:B,cloneInto:A,chrome:H,dispatchEvent:q,removeEventListener:G}=t,W=P,J=F[y],{apply:X}=Reflect,z=X.call.bind({}.hasOwnProperty),K=X.call.bind(X.call),{forEach:Q,includes:Y}=[],{getElementsByTagName:Z}=n,{then:ee}=O[y],{indexOf:te,slice:ne}="",oe=X.call.bind("".charCodeAt),{append:ae,appendChild:re,attachShadow:se,remove:ie,setAttribute:ce}=Element[y],{assign:le,defineProperty:de,getOwnPropertyDescriptor:ue,getPrototypeOf:pe,keys:fe}=I,we=I.create.bind(I,null),{random:me}=Math,{toStringTag:he}=Symbol,{stopImmediatePropagation:be}=Event[y],ye=ue(j[y],"detail").get,ge=ue(U[y],"relatedTarget").get,ve=L(console),Re=H.runtime.getURL(""),_e=(e,t)=>{for(let n=e;h(n)&&(n=pe(n));)if(n===t)return!0},ke=(e=>t=>_e(t,e))(O[y]);let Ce=!H.app;(()=>{"use strict";var L;let{browser:I}=t;if(Ce||null!=(L=I)&&L.runtime);else{const{Proxy:e}=t,{bind:n}=e,o="message",r="stack",s=e=>"addListener"===e||"removeListener"===e||"hasListener"===e||"hasListeners"===e,i=(e,t,o,a)=>{const r=o[t];if(void 0===r)return;let i;return i=m(a)?a(o,r):m(r)?0===a||s(t)||!z(o,t)?K(n,r,o):l(o,r):h(r)&&0!==a?c(r,a):r,e[t]=i,i},c=(t,n)=>new e({__proto__:null},{__proto__:null,get:(e,o)=>{var a;return null!=(a=e[o])?a:i(e,o,t,null==n?void 0:n[o])}}),l=(e,t,n)=>(...s)=>{let i,c;const l=new O((e,t)=>{i=e,c=t}),d=new W(`callstack before invoking ${t.name||"chrome API"}:`);S(s,e=>{const t=H.runtime.lastError,a=t||(n?n(i,e):i(e));a&&(t||(d[r]=`${a[1]}\n${d[r]}`),d[o]=t?a[o]:`${a[0]}`,d.isRuntime=!!t,c(d))});try{X(t,e,s)}catch(e){if("Extension context invalidated."!==e[o])throw e;console.error(`Please reload the tab to restore ${a} API for userscripts.`)}return l},d=(e,t)=>[e,t&&(t[o]?[t[o],t[r]]:[t,(new W)[r]])],u=async(e,t)=>{try{t(d(await e))}catch(e){t(d(0,e))}},p=(e,t,n,o)=>{try{const a=e(t,n);if(a&&ke(a))return u(a,o),!0;void 0!==a&&o(d(a))}catch(e){o(d(0,e))}},f=(e,t)=>(t?t[1]:"null response")||e(t[0]),w=(e,t)=>l(e,t,f);I=t.browser=c(H,{extension:0,i18n:0,runtime:{connect:0,getManifest:0,getURL:0,onMessage:{addListener:(e,t)=>o=>K(t,e,K(n,p,null,o))},sendMessage:w},tabs:!1})}const de=I,me="metaStr",he=t.browser;function Le(e){for(const t in e)if(z(e,t))return!1;return!0}he.windows;const xe=/(Receiving end does not exist)|The message port closed before|$/;function Me(e,t,n){return $e({cmd:e,data:t},n)}function $e(e,{retry:t}={}){return t?Te(e):he.runtime.sendMessage(e)}async function Te(e,t=1e4){for(let n=performance.now();performance.now()-n<t;){try{const t=await $e(e);if(void 0!==t)return t}catch(e){if(!xe.exec(e)[1])throw e}await he.storage.local.get(a)}throw new P(a+" cannot connect to the background page.")}const Ee=(e,t)=>{const a=A?A(t,n):t,r=new j(e,{__proto__:null,detail:a});K(q,o,r)},Se=(e,t,n)=>{let a;K(B,o,e,e=>{if(K(be,e),a)a.node=K(ge,e),n.onHandle(a),a=null;else{const t=K(ye,e),r=A?A(t,o):t;a=r.node&&r,a||n.onHandle(r)}},!0),n.post=(e,a,r,s)=>{const i=n.ids?s:r,c=i&&new U(t,{__proto__:null,relatedTarget:i});Ee(t,{cmd:e,data:a,node:!!c}),c&&K(q,o,c)}},De=ue(MessageEvent[y],"data").get,{port1:je,port2:Pe}=new MessageChannel,Ue=je.postMessage.bind(je),Ie=we();let Oe=0;function Fe(){return new O(e=>{Ie[Oe+=1]=e,Ue(Oe)})}Pe.onmessage=e=>{const t=K(De,e),n=Ie[t];delete Ie[t],Oe===t&&(Oe-=1),n()};const Ne=(e,t)=>k(K(Z,n,e),t||0),{TextDecoder:Ve}=t,{createElementNS:Be}=n,Ae=Ve[y].decode,He=RegExp[y].test,qe=(e,t,o)=>new O(a=>{if(Ne(e))a(t(o));else{const r=new MutationObserver(()=>{Ne(e)&&(r.disconnect(),a(t(o)))});r.observe(n,{childList:!0,subtree:!0})}}),Ge=(e,t)=>{const o=K(Be,n,"http://www.w3.org/1999/xhtml",e);return t&&_(t)?K(ae,o,t):t&&K(Q,fe(t),e=>{"textContent"===e?K(ae,o,t[e]):K(ce,o,e,t[e])}),o},We=(e,t)=>{let n;const o=K(te,e,","),a=o<0?"":K(ne,e,0,o),r=o<0?e:K(ne,e,o+1);if(!1===t)return`data:${a};base64,${r}`;if(n=V(r),K(He,/[\x80-\xFF]/,n)){const e=n.length,o=new N(e);for(let t=0;t<e;t+=1)o[t]=oe(n,t);n=t?o:K(Ae,new Ve,o)}return t?new D([n],{type:a}):n},Je=we(),Xe=we(),ze=[],Ke=(e,t,n)=>{n||Ze[l]?le(e,t):ze.push(()=>le(e,t))},Qe=Ke.bind({},Je),Ye=Ke.bind({},Xe),Ze={__proto__:null,ids:we(),cache:we(),pathMaps:we(),async onHandle({cmd:e,data:t,node:n},o){const a=Je[e];let r,i=t&&k(t,v);i&&(t=t.data);try{r=!0===a?Me(e,t):K(a,n,t,o||s),ke(r)&&(r=await r)}catch(e){i="Error",r=e}i&&Ze.post("Callback",{id:i,data:r},o)}},et=Ze;let tt,nt,ot,at;he.runtime.onMessage.addListener(async({cmd:e,data:t},n)=>{try{const o=Xe[e];o&&await o(t,n)}catch(e){ve.error(e)}}),Ce&&B("copy",tt=e=>ot&&nt(e),!0),ze.push(({clipFF:e})=>{if(e){const{execCommand:e}=n,{setData:t}=DataTransfer[y],{get:o}=ue(ClipboardEvent[y],"clipboardData"),{preventDefault:a,stopPropagation:r}=Event[y];nt=e=>{K(r,e),K(be,e),K(a,e),K(t,K(o,e),ot.type||"text/plain",ot.data)},at=t=>{ot=t,K(e,n,"copy"),ot=null}}Qe({SetClipboard:at||!0})});const rt=we(),st=["script","style","link","meta"],{toLowerCase:it}="";let ct,lt;async function dt(e){if(lt){if(e){if(ct)return;ct=Fe,await ct,ct=null}Me("SetPopup",x({menus:rt},et,["ids",l]))}}Ye({PopupShown(e){lt=e,dt()}},!0),Qe({AddElement({tag:e,attrs:t,cbId:n},o){let a,r;try{const n=this||K(Y,st,K(it,`${e}`))&&Ne("head")||Ne("body")||Ne("*");a=Ge(e,t),K(re,n,a)}catch(e){r=[`${e}`,e.stack]}et.post("Callback",{id:n,data:r},o,a)},GetResource({id:e,isBlob:t,key:n,raw:o}){var a;return o||(o=et.cache[(null==(a=et.pathMaps[e])?void 0:a[n])||n]),!o||We(o,t)},RegisterMenu({id:e,cap:t}){g&&(M(rt,e,t,1),dt(!0))},UnregisterMenu({id:e,cap:t}){var n;g&&(null==(n=rt[e])||delete n[t],dt(!0))}});const ut=ue(PageTransitionEvent[y],"persisted").get,pt=[];let ft;function wt(e,t){S(pt,e),et.ids[e]=t||s,ft||(ft=mt(2))}async function mt(e){for(;--e>=0;)await Fe();Me("SetBadge",pt),ft=!1}ze.push(()=>{Qe({Run:wt}),B("pageshow",e=>e.isTrusted&&K(ut,e)&&mt())});const ht=et.ids;let bt,yt,gt,vt,Rt,_t,kt,Ct=o[e];function Lt({[w]:e}){Rt=!1;const n=e+"VW",a=n+"*",r=T(),s=T(),i=T(),c=T();return Ce?K(B,o,n,e=>{K(be,e),_t?(K(q,_t,new j(a,{__proto__:null,detail:jt(K(ye,e),_t)})),_t=null):_t=K(ge,e)},!0):C(t,n,jt,!1),l(opener)||l(!g&&parent)?d():$t({code:`parent["${r}"] = [this, 0]`},()=>{Ce&&!Pt(o.wrappedJSObject[r])||d()}),Rt;function l(e){let t;if(e&&ue(e.location,"href").get)if(Ce){const s=e=>{t=K(ye,e)};K(B,o,a,s,!0),K(q,e,new U(n,{relatedTarget:o})),K(q,e,new j(n,{detail:r})),K(G,o,a,s,!0)}else t=e[n],t=t&&t(r,o);return t}function d(){K(B,o,s,u,{capture:!0,once:!0}),$t({code:`(${Ct}(${Ce},'${s}','${r}'))()\n//# sourceURL=${Re}sandbox/injected-web.js`}),K(G,o,s,u,!0)}function u(e){Rt=!0,K(be,e),Se(i,c,et),Ee(`${s}*`,[c,i])}}async function xt(e,t){var o,a;const{errors:r,info:l,[d]:u}=e;r&&ve.warn(r),Ce&&(Ce=parseFloat(l.ua.browserVersion)),yt=we(),yt[s]=l,yt[i]=l,le(et.cache,e.cache),t||e[c]?Rt=!1:e[s]&&null==Rt&&Lt(e);const p=e.scripts.filter(e=>Mt(e)===i).map(e=>[e.id,e.key.data]),f=(u||p.length)&&Me("InjectionFeedback",{[c]:!Rt,[i]:p,[d]:u,url:Ce&&b.href}),w=ue(Document[y],"readyState").get,m=gt;if(m&&St(),await qe("*",Tt,"start"),(null!=(o=vt)&&o.body||null!=(a=gt)&&a.body)&&await qe("body",Tt,"body"),u&&(e=await f)){le(et.cache,e.cache),"loading"===K(w,n)&&(await new O(e=>{B("DOMContentLoaded",e,{once:!0})}),await 0);for(let t=0,n=e.scripts;t<n.length;t++)Mt(n[t]);gt&&!m&&St(),await Tt("end"),await Tt("idle")}yt=gt=vt=Ct=null}function Mt(e){let t=e[l];if(t=t===r&&!Rt||t===i?i:Rt&&s,t){const n=t===i?gt||(gt=we()):vt||(vt=we()),{gmi:o,[me]:a,pathMap:r,runAt:s}=e,c=n[s]||(n[s]=[]);S(c,e),C(o,"scriptMetaStr",a[0]||K(ne,e.code[a[1]],a[2],a[3])),delete e[me],r&&(et.pathMaps[e.id]=r)}else ht[e.id]=u;return t}function $t(e,t){const{code:a}=e,r=h(a),s=Ge("script",!r&&a),i=Ce&&!t&&(t=>{const{stack:n}=t.error;n&&!`${n}`.includes(Re)||(E("error",[e.displayName],t.error),t.preventDefault())}),c=Ge("div"),l=kt||(se?K(se,c,{mode:"closed"}):c);let d,u;r&&X(ae,s,a),t?(d=Ge("iframe",{src:"javascript:void 0",sandbox:"allow-same-origin allow-scripts",style:"display:none!important"}),Ce||K(re,l,d)):K(re,l,s),i&&K(B,o,"error",i),kt||K(re,Ne("*")||n,c),i&&K(G,o,"error",i),t&&(kt=l,Ce&&K(re,l,d),(u=d.contentDocument)&&(K(re,K(Z,u,"*")[0],s),t()),K(ie,d),kt=null),K(ie,s),K(ie,c)}function Tt(e){let t;for(let n=1;n>=0;n--){const o=n?s:i,a=n?vt:gt,r=null==a?void 0:a[e];if(r){et.post("ScriptData",{items:r,info:yt[o]},o),yt[o]=!1,bt||(bt=we());for(let e=0;e<r.length;e++){const{id:t}=r[e];bt[t]=1}n?Ce||(t=Et(e)):K(ee,Fe(),Dt)}}return t}async function Et(e){const t=vt[e];for(let n=0;n<t.length;n++){const o=t[n];o.code&&("idle"===e&&await Fe(),"end"===e&&await 0,o.meta.unwrap||et.post("Plant",o.key),$t(o),o.code="",o.meta.unwrap&&wt(o.id))}Dt()}function St(){const e=Ct(Ce)(et.onHandle),t=et.post;et.post=(n,o,a,r)=>{(a===i?e:t)(n,o,void 0,r)}}function Dt(){for(const e in bt)1===ht[e]&&(ht[e]=p);bt=null}function jt(e,t){const{post:n}=et;if(n)return n("WriteVault",e,s,t),!0}function Pt(e){if(!e)return;const t=A(we(),n),o=A(we(),n);return K(Q,["log","info","warn","error","debug"],e=>{o[e]=exportFunction(ve[e],n)}),t.console=o,e[1]=t,!0}C(o,e,1,!1),Qe({InjectList:Ce&&Et});const Ut=we();Qe({async Notification(e,t){const n=await Me("Notification",e);Ut[n]={id:e.id,realm:t}},RemoveNotification(e){for(const t in Ut)if(Ut[t].id===e)return delete Ut[t],Me("RemoveNotification",t)}}),Ye({NotificationClick(e){const t=Ut[e];t&&et.post("NotificationClicked",t.id,t.realm)},NotificationClose(e){const t=Ut[e];t&&(et.post("NotificationClosed",t.id,t.realm),delete Ut[e])}});const{fetch:It,FileReader:Ot,FormData:Ft}=t,{arrayBuffer:Nt,blob:Vt}=J,{createObjectURL:Bt,revokeObjectURL:At}=URL,Ht=D[y],qt=ue(Ht,"type").get,Gt=ue(pe(N[y]),"buffer").get,Wt=ue(Ot[y],"result").get,Jt=Ot[y].readAsDataURL,Xt=Ft[y].append,zt=[R],Kt=we();let Qt=$();async function Yt(e,t){const n=await K(e.asBlob?Vt:Nt,await It(t));return Me("RevokeBlob",t),n}function Zt(e,t){const n=Bt(e),o=Ge("a",{href:n,download:t}),a=K(ee,Qt,()=>{K(q,o,new U("click")),en(n)});return Qt=K(ee,a,()=>Me("SetTimeout",150)),a}async function en(e){await Me("SetTimeout",3e3),At(e)}function tn(e,t,n){const o=(t=V(t)).length,a=e.arr||(e.arr=new N(n?n.size:o));for(let e=(null==n?void 0:n.chunk)||0,r=0;r<o;)a[e++]=oe(t,r++);return a}async function nn(e,t){if("fd"===t){if(!e.length)return[e,t];const n=new Ft;K(Q,e,e=>K(Xt,n,e[0],e[1])),e=n}const n=_e(e,Ht),o=n?e:await K(Vt,new F(e)),a=new Ot;return new O(e=>{K(B,a,"load",()=>e([K(Wt,a),K(qt,o),n])),K(Jt,a,o)})}Qe({async HttpRequest(e,t){Kt[e.id]=x({realm:t,asBlob:"blob"===e.xhrType},e,zt);let{data:n}=e;return!Ce&&n.length>1&&"usp"!==n[1]&&(n=await nn(n[0],n[1]),e.data=A?A(n,e):n),Me("HttpRequest",e)},AbortRequest:!0}),Ye({async HttpRequested(e){const{id:t,data:n}=e,o=Kt[t];if(!o)return;if(z(e,"chunk"))return void tn(o,n,e);let a=null==n?void 0:n[f];a&&!Ce&&(e.blobbed&&(a=await Yt(o,a)),e.chunked&&(a=tn(o,a),a=o.asBlob?new D([a],{type:e.contentType}):K(Gt,a),delete o.arr),n[f]=a),a&&o[R]&&(o[f]=a),"load"===e.type&&o[R]&&await Zt(o[f],o[R]),"loadend"===e.type&&delete Kt[e.id],et.post("HttpRequested",e,o.realm)}});const on=we(),an=we(),rn=we();Qe({async TabOpen({key:e,data:t},n){const{id:o}=await Me("TabOpen",t);on[e]=o,an[o]=e,rn[o]=n},TabClose(e){const t=on[e];e&&!t||Me("TabClose",{id:t})}}),Ye({TabClosed(e){const t=an[e],n=rn[e];delete rn[e],delete an[e],delete on[t],t&&et.post("TabClosed",t,n)}});const{ids:sn}=et;async function cn(e){const t=self.vmData||await O.race([new O(e=>{self.vmResolve=e}),e]);return delete self.vmResolve,delete self.vmData,t}function ln(){try{const t=`"${e}"`,o=n.cookie.split(`${t}=`)[1],a=o&&o.split(";",1)[0];if(a){n.cookie=`${t}=0; max-age=0; SameSite=Lax`;const e=new XMLHttpRequest,o=`blob:${Re}${a}`;return e.open("get",o,!1),e.send(),URL.revokeObjectURL(o),JSON.parse(e[f])}}catch(e){}}Ye({Command:e=>et.post("Command",e,sn[e.id]),Run:e=>wt(e,i),UpdatedValues(e){const t=we(),n=we();K(Q,fe(e),o=>{(sn[o]===i?n:t)[o]=e[o]}),Le(t)||et.post("UpdatedValues",t),Le(n)||et.post("UpdatedValues",n,i)}}),Qe({TabFocus:!0,UpdateValue:!0}),(async()=>{const e=n instanceof XMLDocument,o=ln(),a=Me("GetInjected",{url:Ce&&b.href,[c]:e,done:!(!o&&!t.vmData)},{retry:!0}),r=o||(Ce&&Event[y].composedPath?await cn(a):await a);le(sn,r.ids),et[l]=r[l],r.expose&&!e&&Lt(r)&&(Qe({GetScriptVer:!0}),et.post("Expose")),Ce&&!r.clipFF&&G("copy",tt,!0),r.scripts&&(ze.forEach(e=>e(r)),await xt(r,e)),ze.length=0,dt()})().catch(Ce&&console.error),Ce&&g&&"file:"===b.protocol&&b.pathname.endsWith(".user.js")&&"application/x-javascript"===n.contentType&&(async()=>{const{fetch:e,history:o}=t,{referrer:a}=n,{text:r}=J,s="cookie"in Document[y],i=b.href,c=async()=>K(r,await e(i,{mode:"same-origin"}));let l,d=await c();function u(){o.length>1?o.go(-1):Me("TabClose")}K(te,d,"// ==UserScript==")<0||(await Me("ConfirmInstall",{code:d,url:i,from:a}),s?de.runtime.onConnect.addListener(e=>{"FetchSelf"===e.name&&(e.onMessage.addListener(async()=>{d=await c(),d===l?d=null:l=d,e.postMessage(d)}),e.onDisconnect.addListener(async()=>{l=null,await Me("CheckInstallerTab",e.sender.tab.id)||u()}))}):u())})().catch(ve.error)})()}}